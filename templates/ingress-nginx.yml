apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: ingress-nginx
  namespace: argocd
  annotations: { argocd.argoproj.io/sync-wave: "-2" }
spec:
  project: default
  destination: { name: in-cluster, namespace: {{ .Values.ingressNginx.namespace }} }
  sources:
  - repoURL: https://kubernetes.github.io/ingress-nginx
    chart: ingress-nginx
    targetRevision: {{ .Values.ingressNginx.version | quote }}
    helm:
      values: |
        controller:
          service:
            type: {{ .Values.ingressNginx.serviceType }}
          ingressClassResource:
            name: nginx
            default: true
  syncPolicy: { syncOptions: [CreateNamespace=true] }
